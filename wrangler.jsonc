/**
 * Wrangler configuration for LLM Chat App Template
 * Unified AI, D1, KV memory, multiple AI endpoints, static assets, observability
 */

{
  "$schema": "node_modules/wrangler/config-schema.json",
  "name": "llm-chat-app-template",
  "main": "src/index.ts",
  "compatibility_date": "2025-04-01",
  "compatibility_flags": [
    "nodejs_compat",
    "global_fetch_strictly_public"
  ],

  // Static assets binding
  "assets": {
    "binding": "ASSETS",
    "directory": "./public"
  },

  // Observability/logging
  "observability": {
    "enabled": true
  },

  // Primary AI binding
  "ai": {
    "binding": "AI"
  },

  // Additional free Cloudflare AI endpoints
  "ai_endpoints": [
    {
      "binding": "TEXT_TO_IMAGE",
      "model": "@cf/stable-diffusion-v1.5",
      "max_tokens": 2048
    },
    {
      "binding": "MULTIPLAYER_GLOBE",
      "model": "@cf/multiplayer-globe",
      "max_tokens": 2048
    }
  ],

  // D1 database binding
  "d1_databases": [
    {
      "binding": "DB",
      "database_name": "openapi-template-db"
    }
  ],

  // KV namespaces for AI memory / session storage
  "kv_namespaces": [
    {
      "binding": "AI_MEMORY",
      "id": "8c5a2eb8be934b078487ae615c0de92e"
    }
  ],

  // Optional: upload TypeScript source maps for debugging
  "upload_source_maps": true
}
